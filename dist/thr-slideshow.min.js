"use strict";angular.module("thr-slideshow",[]).directive("thrSlideshow",[function(){return{restrict:"E",scope:!0,templateUrl:"thr-slideshow.html",link:function(e,t){function n(){var e=160,t=document.getElementsByClassName("preview-area")[0],n=parseInt(t.offsetWidth/e);return 0===n&&(n=parseInt(window.innerWidth/e)),n>7?7:n<3?2:n}function i(t){document.fullscreenEnabled||document.mozFullscreenEnabled||document.webkitIsFullScreen||document.msFullscreenElement||e.isMaximized?l():document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||s(t)}function s(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function l(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}e.slideshow=$rootScope.slideshow,e.translation=translation,e.selectedImg=[],e.thumbnails=[],e.hidePlayIcon=!0,e.isMaximized=!1,e.close=function(){e.hidePlayIcon=!0,e.pause(),e.isMaximized=!1,e.slideshow.hide(),l()},e.$watch("slideshow.visible",function(t){t&&e.slideBox(e.slideshow.photoIndex)}),e.slideBox=function(t){return t<e.selectedIndex?e.directionIsNext=!1:e.directionIsNext=!0,e.selectedIndex=t,e.selectedImg=e.slideshow.photosList[t],e.showPopup=!0,e.thumbnails=c(t),e.play(),!1},e.selectedIndex=e.slideshow.photoIndex,e.playSlide=void 0,e.directionIsNext=!0;var o=0;e.selectedThumbIndex=0;var c=function(t){var i=n();i<t||i===t?o=t-i+1:o>t&&(o=t);for(var s=e.slideshow.photosList.length,l=[],c={},d=o,a=0;a<i&&(c={},d%=s,c.index=d,t===d&&(e.selectedThumbIndex=a),c.photo=e.slideshow.photosList[d],l.push(c),d+=1,s!==a+1);a++);return i=d,l};angular.element(window).bind("resize",function(){e.thumbnails=c(e.selectedIndex),e.$digest()}),angular.element(window).keyup(function(t){switch(t.keyCode){case 27:e.isMaximized?(e.isMaximized=!e.isMaximized,l()):e.close();break;case 39:e.next();break;case 37:e.preview();break;case 80:e.playOrPause()}}),e.next=function(){e.directionIsNext=!0;var t=e.slideshow.photosList.length;e.selectedIndex=(e.selectedIndex+1)%t,e.selectedImg=e.slideshow.photosList[e.selectedIndex],e.thumbnails=c(e.selectedIndex),e.play()},e.preview=function(){e.directionIsNext=!1;var t=e.slideshow.photosList.length;0===e.selectedIndex?e.selectedIndex=t-1:e.selectedIndex-=1,e.selectedImg=e.slideshow.photosList[e.selectedIndex],e.thumbnails=c(e.selectedIndex),e.play()},e.playOrPause=function(){e.hidePlayIcon=!e.hidePlayIcon,e.playSlide?e.pause():e.play()},e.play=function(){e.hidePlayIcon=!0,interval.cancel(e.playSlide),e.playSlide=interval(function(){e.next()},5e3)},e.pause=function(){e.hidePlayIcon=!1,e.playSlide&&(interval.cancel(e.playSlide),e.playSlide=void 0)},e.maximize=function(t){var n=angular.element(t.target).closest(".new-slideBox")[0];i(n),e.isMaximized=!e.isMaximized}}}}]),angular.module("thr-slideshow").run(["$templateCache",function(e){e.put("thr-slideshow.html",'<div>\r\n\t<div id="new-slideBox-base"></div>\r\n\t<div class="new-slideBox" ng-swipe-left="next()" ng-swipe-right="preview()">\r\n\t\t<a ng-class="{\'icon-resize\':!isMaximized, \'icon-collapse\': isMaximized}" ng-click="maximize($event)"></a>\r\n\t\t<a class="icon-close" ng-click="close()"></a>\r\n\t\t<div ng-click="close()" class="image-area" ng-class="{maximized : isMaximized, \'only-one\':slideshow.photosList.length === 1}">\r\n\t\t\t<ul ng-if="slideshow.photosList.length">\r\n\t\t\t\t<li ng-repeat="photo in slideshow.photosList" ng-class="{\'next\':directionIsNext,\'preview\':!directionIsNext, selected:$index === selectedIndex, disable:$index !== selectedIndex}">\r\n\t\t\t\t\t<div ng-class="{\'photo-with-description table-layout\':(photo.description && !isMaximized),\'photo-container\':(!photo.description || isMaximized)}">\r\n\t\t\t\t\t\t<div class="photo" ng-class="{\'maximizedPhoto\': isMaximized, \'column-layout\':photo.description && !isMaximized}" >\r\n\t\t\t\t\t\t\t<img  ng-click="playOrPause(); $event.stopPropagation();" ng-src="{{photo.path}}" alt="" />\r\n\t\t\t\t\t\t\t<a  ng-click="playOrPause(); $event.stopPropagation();" class="container-icon-play" ng-hide="hidePlayIcon"><span class="icon-play"></span></a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div ng-if="photo.description && !isMaximized" class="column-layout description-container">\r\n\t\t\t\t\t\t\t<p class="description">{{photo.description}}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div class="preview-area" ng-show="thumbnails.length > 1 && !isMaximized">\r\n\t\t\t<a class="icon-angle-left" ng-click="preview()"></a>\r\n\t\t\t<ul>\r\n\t\t\t\t<li class="thumbnail-item" ng-repeat="thumb in thumbnails">\r\n\t\t\t\t\t<div ng-class="{selected:$index === selectedThumbIndex}"  ng-click="slideBox(thumb.index)" >\r\n\t\t\t\t\t\t<img class="thumbnail"  ng-src="{{thumb.photo.path}}" alt="" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t\t<a class="icon-angle-right" ng-click="next()"></a>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]);